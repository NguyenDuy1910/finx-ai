User Request: {{ user_query }}

{% if conversation_history %}
Previous conversation context:
{% for msg in conversation_history %}
- {{ msg.role }}: {{ msg.content[:100] }}...
{% endfor %}

{% endif %}
{% if schema_context %}
Relevant schema information:
{{ schema_context }}

{% endif %}
Generate SQL query following the Chain of Thought process.
