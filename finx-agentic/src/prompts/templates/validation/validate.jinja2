Generated SQL:
```sql
{{ generated_sql }}
```

Database: {{ database }}

{% if schema_context %}
Schema Context:
{% for table in schema_context.tables %}
Table: {{ table.database }}.{{ table.table_name }}
  Columns: {{ table.matched_columns | join(', ') }}
  Partition Keys: {{ table.partition_keys | join(', ') }}
{% endfor %}
{% endif %}

{% if original_query %}
Original User Query: {{ original_query }}
{% endif %}

Validate this SQL query. Check syntax, schema references, partition filters, and safety. Return valid JSON only.

